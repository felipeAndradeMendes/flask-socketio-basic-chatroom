{% extends 'base.html' %}

{% block content %}
    <div class="message-box">
        <h2>Chat Room: {{ room }}</h2>
        <div class="messages" id="messages"></div>
        <div class="inputs">
            <input type="text" rows="3" placeholder="Message" name="message" id="message">
            <button type="button" name="send" id="send-btn" onclick="sendMessage()">
                Send
            </button>
        </div>
    </div>
<script type="text/javascript">
    var socketio = io()

    const sendMessage = () => {
        const message = document.getElementById('message').value
        socketio.emit('mensagem', {usuario: '{{ session.name }}', texto: message })
    }

    socketio.on('feedback msg', function(data){
        const p = document.createElement('p')
        p.textContent = data.usuario + ": " + data.texto
        document.getElementById('messages').appendChild(p)
    })


</script>
{% endblock %}